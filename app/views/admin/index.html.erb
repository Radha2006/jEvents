<section id = "admin">
	<h2>Admin: Dashboard</h2>

	<h3>Venues</h3>
	<table class="table table-striped table-bordered table-condensed">
		<tr>
			<th>Name</th>
			<th>Area</th>
			<th>Contact Person</th>
			<th>Email</th>
			<th>Mobile</th>
			<th>User</th>
			<th>Approved?</th>
			<th>View?</th>
			<th>Booking?</th>
			<th>Enquiry?</th>
			<th></th>
		</tr>

		<% @venues.each do |venue| %>
		<tr>
			<td><%= venue.name %></td>
			<td><%= venue.address.area %></td>
			<td><%= venue.contact.firstname %> <%= venue.contact.lastname %></td>
			<td><%= venue.contact.email %></td>
			<td><%= venue.contact.mobile_number %></td>
			<td><%= venue.user.name %>[<%= venue.user.email %>]</td>
			<td><%= best_in_place venue, :is_approved, :type => :checkbox %></td>
			<td><%= best_in_place venue, :view_available, :type => :checkbox %></td>
			<td><%= best_in_place venue, :booking_available, :type => :checkbox %></td>
			<td><%= best_in_place venue, :enquiry_available, :type => :checkbox %></td>
			<td>
				<%= link_to raw('<i class="icon-eye-open"></i>'), venue, :rel => "modal:open" %>&nbsp;&nbsp;
				<%= link_to raw('<i class="icon-pencil"></i>'), edit_venue_path(venue) %>&nbsp;&nbsp;
				<%= link_to raw('<i class="icon-trash"></i>'), venue, method: :delete, data: { confirm: 'Are you sure?' } %>
			</td>
		</tr>
		<% end %>
	</table>

	<h3>Users</h3>
	<%= link_to "Create new user", new_admin_user_path, :class => 'btn btn-success fr' %>
	<table class="table table-striped table-bordered table-condensed">
		<thead>
			<tr>
				<th>UserId</th>
				<th>Email</th>
				<th>Name</th>
				<th>Roles</th>
				<th>Created at</th>
				<th>Locked?</th>
				<th></th>
			</tr>
		</thead>
		<tbody>
			<% @users.each do |user| %>
			<tr>
				<td><%= user.id %></td>
				<td><%= link_to user.email, admin_user_path(user) %></td>
				<td><%= user.name %></td>
				<td><%= user.roles.pluck(:name) %></td>
				<td><%= user.created_at %></td>
				<td><%= if user.locked_at.nil? then 'No' else 'Yes' end %></td>
				<td>
					<%= link_to raw('<i class="icon-eye-open"></i>'), admin_user_path(user) %>&nbsp;|
					<%= link_to raw('<i class="icon-pencil"></i>'), edit_admin_user_path(user) %>&nbsp;|
					<%= link_to_unless user.id == current_user.id, raw('<i class="icon-trash"></i>'), admin_user_path(user), :method => :delete, :confirm => "Are you sure?" %>
				</td>
			</tr>
			<% end %>
		</tbody>
	</table>
</section>