<% content_for :title, "Search" %>

<% @options = populateSearchCriteria %>
<% @options.areas.shift #Removes first element from array, which is "All areas" %>
<% @budget = getBudgetOrCapacity('Budget') %>
<% @capacity = getBudgetOrCapacity('Capacity') %>
<% @selectedArea = @query.areas.first %>

<div class="row">
	<div class="filters span2" style="margin-top:5em;">
		<h5>Areas</h5>
		<input class="span2" type="text" id="areaSearchKey" onkeyup='textChanged(<%= raw @options.areas %>)' />

		<ul id="area">
			<% @options.areas.each do |c| %>
			<% text = c.first.to_s  # c.first or c[0] gives the text. %>
			<% gen_id = text.gsub(/[\s\.]+/, "") %>
			<li id="<%= gen_id %>" style="cursor:pointer;"> 
				<label for=<%='chk_area_' + gen_id %> >
					<a>
						<%= check_box_tag 'chk_area_' + gen_id, text, (@selectedArea == text), :onchange => 'searchFired();' %>
						<span><%= text %> </span>
					</a>
				</label>
			</li>
			<% end %>
		</ul>

		<h5>Capacity</h5>
		<ul id='cap'>
			<%  @capacity.each do |c| %>
			<li id="<%= c.text.gsub(/\s+/, "") %>"> 
				<label for=<%='chk_cap_' + c.text.gsub(/\s+/, "")%>> 
					<a>
						<%= check_box_tag 'chk_cap_' + c.text.gsub(/\s+/, ""), c.text, false, :onclick => 'searchFired();' %> 
						<span><%= c.text %> </span>
					</a>
				</label>
			</li>
			<% end %>
		</ul>
		<%if 1 ==2 %>
		<h5>Budget</h5>
		<ul id='bud'>
			<%  @budget.each do |b| %>

			<li id="<%= b.text.gsub(/\s+/, "") %>"> 
				<label for=<%='chk_bud_' + b.text.gsub(/\s+/, "")%>>
					<%= check_box_tag 'chk_bud_' + b.text.gsub(/\s+/, ""), b.text, false, :onclick => 'searchFired();' %> 
					<a>
						<span><%= b.text %> </span>
					</a>
				</label>
			</li>
			<% end %>
		</ul>
		<% end %>

		<h5>Amenities</h5>
		<ul id='am'>
			<%  @options.amenities_name.each_with_index do |a, index| %>
			<li id="<%= a.to_s.gsub(/\s+/, "") %>"> 
				<label for=<%='chk_am_' + a.to_s.gsub(/\s+/, "")%>>
					<%= check_box_tag 'chk_am_' + a.to_s.gsub(/\s+/, ""), @options.amenities_val[index], false, :onclick => 'searchFired();' %> 
					<a>
						<span><%= a %> </span>
					</a>
				</label>
			</li>
			<% end %>
		</ul>


	</div>
	<%= select_tag(:eventType, options_for_select(@options.eventType, @query.eventType), {:style => "float:right", :onchange => 'searchFired();'}) %>

	<div class="span9" style="margin-top:10px;margin-left:80px;">
		<div id="results_div">
			<%= render partial: 'venues/results' %>
		</div>
	</div> 
</div>
